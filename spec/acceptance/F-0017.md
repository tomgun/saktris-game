---
feature: F-0017
status: shipped
validation: []  # TODO: Add validation commands
---

# F-0017: DrawRules

## Acceptance Criteria

### AC1: 50-Move Rule
- Draw detected when 50 moves pass without capture or pawn move
- Half-move counter tracks qualifying moves
- Counter resets on capture or pawn move

### AC2: Threefold Repetition
- Position hash computed for each board state
- Draw detected when same position occurs three times
- Position includes piece positions, turn, and castling rights

### AC3: Insufficient Material
- Draw detected for King vs King
- Draw detected for King+Bishop vs King
- Draw detected for King+Knight vs King
- Draw detected for King+Bishop vs King+Bishop (same color bishops)

### AC4: Draw UI
- "Draw!" message displayed when draw condition met
- Game ends cleanly on draw
- Draw reason logged (for debugging)

### AC5: Action Mode Exception
- Draw rules disabled in Action Mode (continuous play)
- Only king capture ends Action Mode games

## Test Notes
- Manual testing by creating draw positions
- Verify position hash correctness
- Test insufficient material detection
