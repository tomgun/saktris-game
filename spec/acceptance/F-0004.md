---
feature: F-0004
status: shipped
validation: []  # TODO: Add validation commands
---

# F-0004: PieceArrivalSystem

## Acceptance Criteria

### AC1: Pieces arrive on schedule
- New piece arrives based on configured frequency (every N moves)
- Arrival happens at start of turn before player acts

### AC2: Next piece preview
- Player can see which piece will arrive next
- Preview updates when piece is placed

### AC3: Placement on back row
- Pieces can only be placed on player's back row (row 1 for White, row 8 for Black)
- Cannot place on occupied squares

### AC4: Column selection
- Player chooses which column to place arriving piece
- Invalid columns are visually indicated

### AC5: Placement ends turn
- After placing a piece, turn immediately ends
- Player cannot move after placing

### AC6: Arrival modes
- Fixed mode: pieces arrive in predetermined order
- Random mode: pieces arrive randomly
- Same mode: both players get same piece type each turn

### AC7: Hovering piece UI
- Piece hovers above board following mouse
- Ghost piece shows where piece will be placed
- Invalid placements show red tint

### AC8: Blocked placement behavior (HN-0003)
- When all back row columns are occupied, piece cannot be placed
- Piece stays in queue waiting until space is available
- Player can move existing pieces instead (not forced to place)
- Piece is NOT lost - remains available for placement when space opens
- Decision: Skip arrival action, piece stays in queue (Option A)

## Test Notes
- Unit tests in tests/unit/test_piece_arrival_rules.gd (14 tests)
- Visual testing for hover/ghost UI
- Blocked placement tests: test_blocked_placement_*
